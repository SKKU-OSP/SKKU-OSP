version: "3.8"
# Please Change the version oa image before deploying

services:
  ## Product
  # FRONTEND:
  #  image: sosd/sosd-frontend-vitejs:test
  #  container_name: sosd-frontend
  #  restart: always
  #  environment:
  #    VIRTUAL_HOST: "sosd.skku.edu"
  #    LETSENCRYPT_HOST: "sosd.skku.edu"
  #  extra_hosts:
  #    - host.docker.internal:host-gateway
  #  networks:
  #    - "net"
  #  ports:
  #    - "4401:5173"
  # OSP:
  #  image: sosd/sosd-backend-django:test
  #  container_name: sosd-backend
  #  restart: always
  #  extra_hosts:
  #    - host.docker.internal:host-gateway
  #  networks:
  #    - "net"
  #  ports:
  #    - "4402:4402"
  ## Dev
  FRONTEND:
    image: sosd/sosd-frontend-vitejs:test
    container_name: sosd-frontend
    restart: always
    environment:
      VIRTUAL_HOST: "sosd-dev.skku.edu"
      LETSENCRYPT_HOST: "sosd-dev.skku.edu"
      VIRTUAL_PORT: 5173
    extra_hosts:
      - host.docker.internal:host-gateway
    networks:
      - "net"
    ports:
      - "4401:5173"
  OSP:
    image: sosd/sosd-backend-django:test
    container_name: sosd-backend
    restart: always
    volumes:
      - "/home/sosd-dev/SKKU-OSP_FB/osp/data/media:/app/data/media"
      - "/home/sosd-dev/SKKU-OSP_FB/osp/static:/app/staticfiles"
    extra_hosts:
      - host.docker.internal:host-gateway
    networks:
      - "net"
    ports:
      - "4402:8000"

networks:
  net:
    external: true
