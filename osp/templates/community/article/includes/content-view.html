{% load tag_templatetag %}
{% load community_tag %}
{% load static %}

<form method="post" action=".." class="" onSubmit="return false;" style="">
    <!--article content-->
    <div class="d-flex flex-column border border-2" style="padding:10px;">
        <div class="d-flex flex-row justify-content-between">
            <div class="border-2 border-bottom" style="flex:1;width:80%;padding-left:10px;margin-bottom:5px;font-weight:bold;">
                {% if board.board_type == 'Recruit' %}
                    [{{ article.team.name |default:"팀이 더이상 존재하지 않습니다." }}]
                {% endif %}
                {{ article.title }}
            </div>
            <div class="d-flex flex-row justify-content-end">
                <div style="line-height:40px;padding-left:10px;">
                    {% if user == article.writer.user %}
                    <span style="cursor:pointer" onclick="edit()">수정</span> 
                    <span style="cursor:pointer" onclick="deleteArticle();">삭제</span>
                    {% elif request.user.is_anonymous %}
                    <a href="">사용자</a>
                    {% elif not article.anonymous_writer %}
                    <div class="dropdown writer-dropdown">
                        <button class="dropdown-toggle writer-dropdown-btn" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                            {{article.writer.user.username}}
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="/user/{{article.writer.user.username}}">프로필</a></li>
                            <li><a class="dropdown-item" href="#" onclick="msgModalOpen({{ article.writer.user.id }})">메시지</a></li>
                        </ul>
                    </div>
                    {% endif %}
                </div>
                <div style="height:40px;line-height:31px;padding-left:10px;" class="d-flex flex-column">
                <div style="height:10px;font-size:5px;">
                    {{ article.pub_date|date:"Y-m-d" }}
                </div>
                <div style="height:10px;font-size:5px;">
                    {{ article.pub_date|time:"h:i a" }}
                </div>
                </div>
                <div class="d-flex flex-row">
                    <div style="height:40px;line-height:40px;font-size:18px;padding-left:3px;" class="material-icons-outlined">visibility</div>
                    <div style="height:40px;line-height:40px;font-size:12px;padding-left:3px;padding-right:3px;">{{ article.view_cnt }}</div>
                </div>
            </div>

        </div>
        <div>
            <div class="border-2 border-bottom" style="width:100%; padding-top:10px; padding-left:10px; overflow:auto; max-height:350px; min-height:350px;">{{ article.body }}</div>
        </div>
        <div style="margin-top:5px;" class="ss-97888 ss-main d-flex flex-row" >
            <div class="ss-multi-selected">
                <div class="ss-values">
                    {% for tag in tags %}
                        <div class="ss-value bg-tag-{{tag.tag.type}}">
                            <span class="ss-value-text"># {{ tag.tag.name }}</span>
                        </div>
                    {% empty %}
                        <span style="padding-left:5px;">태그 없음</span>
                    {% endfor %}
                </div>
            </div>
            <div class="d-flex flex-row justify-content-between" style="width:65px;height:30px;">
                <div onclick="ArticleThumbUp(this, {{ article.id }},{{ request.user.id | default_if_none:-1 }})"
                    {% is_article_thumb_up article request.user as is_thumb_up %}
                    {% if not is_thumb_up %}
                        class="material-icons-outlined h-100 pointer opacity-hover"
                    {% else %}
                        class="material-icons h-100 pointer opacity-hover"
                    {% endif %}
                        style="line-height:30px;font-size:21px;padding-left:5px;">
                    thumb_up
                </div>
                <div onclick="ArticleScrap(this, {{ article.id }}, {{ request.user.id | default_if_none:-1 }})"
                    {% is_article_scrap article request.user as is_scrap %}
                    {% if not is_scrap %}
                        class="material-icons-outlined h-100 pointer opacity-hover"
                    {% else %}
                        class="material-icons h-100 pointer opacity-hover"
                    {% endif %}
                    class="material-icons-outlined h-100 pointer opacity-hover"
                    style="line-height:30px;font-size:23px;padding-right:3px;">
                    bookmark_border
                </div>
            </div>
{#            <input name='tags' value='tag1,tag2' placeholder="게시판 관련 태그" style="border-top:none;border-left:none;border-right:none;" readonly >#}

        </div>
    </div>
</form>
{% if board.board_type == 'Recruit' %}
<div class="form-control d-flex flex-row justify-content-between" style="width:100%;padding-bottom:10px;margin-top:5px;">
    {% if article.team %}
    <div class="d-flex flex-row">
        <div class="f-bold">팀 정보 |</div>
        <div>{{ article.team.name }} <br> {{ article.team.description }}</div>
    </div>
        {% is_teammember article.team request.user as is_teammember %}
        {% if not is_teammember %}
            {% teaminvitemessage article.team request.user as waited_teaminvitemessage %}
            {% if not waited_teaminvitemessage %}
            <div>
                <button id="team-apply"
                        {% if request.user.is_anonymous %}onclick="alert('로그인 후 이용해주세요.')"{% else %}onclick="openTeamApplyModal({{ article.team.id }});" {% endif %}
                        data-team-id="{{ article.team.id }}" class="btn btn-secondary h-100" style="font-size:13px;">지원하기</button>
            </div>
            {% else %}
            <div>
                <div class="btn btn-secondary" style="font-size:13px; cursor:default;">{{ waited_teaminvitemessage.get_status_display }}</div>
            </div>
            {% endif %}
        {% endif %}
    {% else %}
        <div>
            팀 정보가 없습니다.
        </div>
    {% endif %}
</div>

    {% if user.is_authenticated %}
        <div class="modal fade" id="AddTeamApplyModal">
        </div>
        <script src="{% static 'js/team_apply_modal.js' %}"></script>
    {% endif %}
{% endif %}