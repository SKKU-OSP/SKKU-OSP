<!DOCTYPE html>
<html lang="ko">
{% extends 'main.html' %}

{% load static %}
{% block content %}
{% if user.is_staff %}
<div class="container mt-4">
    <table class="table table-striped table-hover" id="scoreTable">
        <thead>
            <tr>
                <th>Repository</th>
                <th>Star</th>
                <th>Fork</th>
                <th>Commits</th>
                <th>PR</th>
                <th>Issues</th>
                <th>Watchers</th>
                <th>Language</th>
                <th>Contributors</th>
                <th>Student Contributors</th>
            </tr>
        </thead>
        <tbody>
            {% for row in data %}
            <tr>
                <td>
                    <a href="https://github.com/{{row.github_id}}/{{row.repo_name}}">
                        {{row.github_id}}/{{row.repo_name}}
                    </a>
                </td>
                <td>{{row.stargazers_count}}</td>
                <td>{{row.forks_count}}</td>
                <td>{{row.commits_count}}</td>
                <td>{{row.prs_count}}</td>
                <td>{{row.open_issue_count|add:row.close_issue_count}}</td>
                <td>{{row.watchers_count}}</td>
                <td>{{row.language}}</td>
                <td>{{row.contributors_count}}</td>
                <td class="contributor_list" data-id="{{row.github_id}}" data-repo="{{row.repo_name}}">{{row.student_contributor|length}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    <div class="contributor_panel" style="position: absolute; display: none; z-index: 2000;"></div>
</div>
{% else %}
<div class="my-5">
    <p align="center">개인 이용자는 접근이 제한된 페이지입니다.</p>
</div>
{% endif %}
{% endblock content %}
{% block script %}
<script src="{% static 'js/repo_rank.js' %}" defer></script>
<!-- Datatables -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css"/> 
<link rel="stylesheet" href="https://cdn.datatables.net/searchpanes/2.0.1/css/searchPanes.bootstrap5.min.css"/> 
<link rel="stylesheet" href="https://cdn.datatables.net/select/1.4.0/css/select.bootstrap5.min.css"/> 
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css"/> 

<script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js" defer></script>
<script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js" defer></script>
<script src="https://cdn.datatables.net/searchpanes/2.0.1/js/dataTables.searchPanes.min.js" defer></script>
<script src="https://cdn.datatables.net/searchpanes/2.0.1/js/searchPanes.bootstrap5.min.js" defer></script>
<script src="https://cdn.datatables.net/select/1.4.0/js/dataTables.select.min.js" defer></script>
<script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js" defer></script>

<link rel="stylesheet" href="{% static 'css/rank.css' %}"/> 
{% endblock script %}

</html>